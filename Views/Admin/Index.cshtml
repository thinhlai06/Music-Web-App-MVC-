@model List<MusicWeb.Models.Entities.Song>
@{
    ViewData["Title"] = "Quản lý Bài hát";
}

<div class="admin-header">
    <h2><i class="fa-solid fa-music" style="margin-right: 10px; color: var(--purple-primary);"></i>Quản lý Bài hát</h2>
    <a href="/Admin/CreateSong" class="btn btn-primary">
        <i class="fa-solid fa-plus"></i> Thêm bài hát
    </a>
</div>

<div class="admin-card">
    <table class="admin-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Bài hát</th>
                <th>Nghệ sĩ</th>
                <th>Thể loại</th>
                <th>Premium</th>
                <th>Thao tác</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var song in Model)
            {
                <tr>
                    <td>@song.Id</td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <img src="@(song.CoverUrl ?? "https://picsum.photos/50")" 
                                 style="width: 40px; height: 40px; border-radius: 6px; object-fit: cover;">
                            <span>@song.Title</span>
                        </div>
                    </td>
                    <td>@song.Artist?.Name</td>
                    <td>@(song.SongGenres?.FirstOrDefault()?.Genre?.Name ?? "-")</td>
                    <td>
                        @if (song.IsPremium)
                        {
                            <span class="badge badge-warning"><i class="fa-solid fa-crown"></i> Premium</span>
                        }
                        else
                        {
                            <span class="badge badge-info">Free</span>
                        }
                    </td>
                    <td>
                        <a href="/Admin/EditSong/@song.Id" class="btn btn-outline" style="padding: 5px 10px;">
                            <i class="fa-solid fa-edit"></i>
                        </a>
                        @if (song.IsPremium)
                        {
                            <form asp-action="RemovePremiumFromSong" method="post" style="display: inline;" 
                                  onsubmit="return confirm('Gỡ Premium khỏi bài hát này?');">
                                <input type="hidden" name="songId" value="@song.Id" />
                                <button type="submit" class="btn btn-outline" style="padding: 5px 10px; color: #ffc107;" title="Gỡ Premium">
                                    <i class="fa-solid fa-crown"></i>
                                </button>
                            </form>
                        }
                        <form asp-action="DeleteSong" method="post" style="display: inline;" 
                              onsubmit="return confirm('Bạn chắc chắn muốn xóa?');">
                            <input type="hidden" name="id" value="@song.Id" />
                            <button type="submit" class="btn btn-danger" style="padding: 5px 10px;">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </form>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
