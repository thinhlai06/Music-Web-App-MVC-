@model MusicWeb.Controllers.AdminController.EditAlbumViewModel

<div class="content-padding">
    <div class="section-title">
        <div style="display: flex; gap: 10px; align-items: center;">
            <a href="/Admin/Albums" class="btn" style="border: 1px solid #fff; padding: 5px 15px; border-radius: 4px; font-size: 14px; text-decoration: none; display: flex; align-items: center; gap: 5px;">
                <i class="fa-solid fa-arrow-left"></i> Quay lại
            </a>
            <span>Sửa Album</span>
        </div>
    </div>

    <div style="display: flex; gap: 30px; margin-top: 20px;">
        <!-- Edit Form -->
        <div style="flex: 1;">
            <h3>Thông tin chung</h3>
            <form asp-action="EditAlbum" method="post" enctype="multipart/form-data">
                <input type="hidden" asp-for="Id" />
                
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">Tên Album</label>
                    <input asp-for="Title" class="form-control" required style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #222; color: #fff;" />
                </div>

                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">Nghệ sĩ</label>
                    <input asp-for="ArtistName" class="form-control" required style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #222; color: #fff;" />
                </div>

                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px;">Ảnh bìa hiện tại</label>
                    <img src="@Model.CoverUrl" style="width: 100px; height: 100px; object-fit: cover; border-radius: 4px; margin-bottom: 10px; display: block;">
                    <input asp-for="CoverFile" type="file" accept="image/*" class="form-control" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #222; color: #fff;" />
                </div>

                <button type="submit" class="btn btn-primary" style="padding: 10px 20px; border: none; border-radius: 4px; background: var(--purple-primary); color: #fff; cursor: pointer;">Lưu Thay Đổi</button>
            </form>
        </div>

        <!-- Songs Management -->
        <div style="flex: 1.5; border-left: 1px solid rgba(255,255,255,0.1); padding-left: 30px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3>Danh sách bài hát</h3>
                <a href="/Admin/CreateSong" class="btn" style="background: rgba(255,255,255,0.1); padding: 5px 10px; border-radius: 4px; text-decoration: none; font-size: 0.9em;">+ Tạo bài hát mới</a>
            </div>

            <div style="margin-bottom: 20px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                <label style="margin-bottom: 10px; display: block;">Thêm bài hát vào album:</label>
                <form asp-action="AddSongToAlbumById" method="post" style="display: flex; gap: 10px;">
                    <input type="hidden" name="albumId" value="@Model.Id" />
                    <select name="songId" required style="flex: 1; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #222; color: #fff;">
                         <option value="">-- Chọn bài hát --</option>
                         @foreach(var song in Model.AvailableSongs) {
                             <option value="@song.Id">@song.Title - @song.Artist.Name</option>
                         }
                    </select>
                    <button type="submit" style="padding: 8px 15px; background: var(--purple-primary); border: none; color: #fff; border-radius: 4px; cursor: pointer;">Thêm</button>
                </form>
            </div>

            @if (Model.Songs.Any())
            {
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="color: var(--text-secondary); text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <th style="padding: 8px;">ID</th>
                            <th style="padding: 8px;">Tên bài hát</th>
                            <th style="padding: 8px;">Thao tác</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var song in Model.Songs)
                        {
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <td style="padding: 8px;">@song.Id</td>
                                <td style="padding: 8px;">
                                    <a href="/Admin/EditSong/@song.Id" style="color: #fff; text-decoration: none;">@song.Title</a>
                                </td>
                                <td style="padding: 8px;">
                                    <form asp-action="RemoveSongFromAlbum" method="post" onsubmit="return confirm('Gỡ bài hát khỏi album?');" style="display: inline;">
                                        <input type="hidden" name="albumId" value="@Model.Id" />
                                        <input type="hidden" name="songId" value="@song.Id" />
                                        <button type="submit" style="color: #ff4d4d; background: none; border: none; cursor: pointer; opacity: 0.8;">Gỡ bỏ</button>
                                    </form>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
            else
            {
                <p style="color: var(--text-secondary); font-style: italic;">Chưa có bài hát nào trong album này.</p>
            }
        </div>
    </div>
</div>
