@model MusicWeb.Models.ViewModels.HomeViewModel

<div id="upload-view" class="content-padding hidden">
    <div class="section-title" style="margin-top: 0;">
        <span>Upload Nhạc Mới</span>
    </div>

    <div class="upload-container">
        <form id="upload-form" enctype="multipart/form-data">
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-4">
                        <label class="form-label">Tên bài hát</label>
                        <input type="text" name="Title" class="auth-input" placeholder="Nhập tên bài hát..." required>
                    </div>
                    
                </div>

                <div class="col-md-6">
                    <div class="form-group mb-4">
                        <label class="form-label">File Nhạc (MP3, WAV)</label>
                        <div class="file-upload-box" id="audio-upload-box">
                            <i class="fa-solid fa-music"></i>
                            <span>Chọn file nhạc</span>
                            <input type="file" name="AudioFile" accept=".mp3,.wav,.ogg" required onchange="updateFileName(this, 'audio-upload-box')">
                        </div>
                    </div>

                    <div class="form-group mb-4">
                        <label class="form-label">Ảnh Bìa (Tùy chọn)</label>
                        <div class="file-upload-box" id="cover-upload-box">
                            <i class="fa-solid fa-image"></i>
                            <span>Chọn ảnh bìa</span>
                            <input type="file" name="CoverFile" accept="image/*" onchange="updateFileName(this, 'cover-upload-box')">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Genre Selection -->
            <div class="row mb-4">
                <div class="col-12">
                     <label class="form-label">Chọn thể loại (Chỉ chọn 1)</label>
                     <div class="genre-selector-container script-scroll">
                        @foreach (var genre in Model.Genres)
                        {
                            <div class="genre-checkbox-item">
                                <input type="radio" id="genre-@genre.Id" name="GenreId" value="@genre.Id" required>
                                <label for="genre-@genre.Id">@genre.Title</label>
                            </div>
                        }
                     </div>
                </div>
            </div>

            <!-- Public/Private Setting -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="form-check form-switch" style="display: flex; align-items: center; gap: 10px;">
                        <input class="form-check-input" type="checkbox" id="isPublicCheck" name="IsPublic" value="true" checked style="width: 40px; height: 20px; cursor: pointer; accent-color: var(--purple-primary);">
                         <input type="hidden" name="IsPublic" value="false">
                        <label class="form-check-label" for="isPublicCheck" style="color: var(--text-secondary); cursor: pointer;">
                            Công khai bài hát này (Mọi người đều có thể nghe)
                        </label>
                    </div>
                </div>
            </div>

            <div class="upload-actions">
                <button type="button" class="btn btn-outline-secondary" onclick="switchView('home')">Hủy bỏ</button>
                <button type="submit" class="pill-btn upload-submit-btn">
                    <i class="fa-solid fa-cloud-arrow-up"></i> Tải lên ngay
                </button>
            </div>

             <div id="upload-progress" class="hidden" style="margin-top: 20px; text-align: center; color: var(--text-secondary);">
                <i class="fa-solid fa-spinner fa-spin"></i> Đang tải lên server... vui lòng không tắt trình duyệt.
            </div>
        </form>
    </div>
</div>

<script>
    function updateFileName(input, boxId) {
        if (input.files && input.files[0]) {
            const box = document.getElementById(boxId);
            const span = box.querySelector('span');
            span.textContent = input.files[0].name;
            box.classList.add('has-file');
        }
    }
</script>
